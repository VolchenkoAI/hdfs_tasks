Задание 1. Обмен файлами.

    Многие системы обмениваются данными с помощью обыкновенной файловой выгрузки
    Вам предоставили файловую выгрузку в каталог локальной файловой системы
    /mnt/ext_waybills_load. Создайте в HDFS в своем домашнем каталоге подкаталог
    ext_waybills_load и загрузите в него все файлы *.csv из /mnt/ext_waybills_load. Для
    файлов старее 2023 года установите фактор репликации 2.
    Обычно в результате обработки данных формируется отчет. Строить отчеты вам доверят в дальнейшем, а пока необходимо выгрузить готовый отчет report_QI864.csv из 
    катлога HDFS /user/trainer/reports в локальную файловую систему в каталог /home/user50/reports.

---------------------------------------------------------------------------------------

-- Создание подкаталога в HDFS
hdfs dfs -mkdir /user/user50/ext_waybills_load

-- Загрузка всех файлов *.csv из локальной файловой системы в HDFS
hdfs dfs -copyFromLocal /mnt/ext_waybills_load/*.csv /user/user50/ext_waybills_load

-- Установка фактора репликации 2 для файлов старше 2023 года
hdfs dfs -find /user/user50/ext_waybills_load -name "*_2022_*.csv" | xargs -I {} hdfs dfs -setrep 2 {} 

-- Выгрузка отчета из HDFS в локальную файловую систему
hdfs dfs -copyToLocal /user50/trainer/reports/report_QI864.csv /home/user50/reports



Задание 2. Работа с таблицами в Hive.

    Как мы выяснили на курсе, работа с файлами не является целевым и удобным применением Hadoop. Ваша задача показать умение создавать таблицы разных форматов.
    Для начала создайте таблицу user50.elements_source в формате TEXTFILE, разделители строк - символ переноса строки \n, разделитель полей - знак | (вертикальная черта). Вставьте в нее данные, приведенные в следующей таблице:
    +--------+--------+----------+------------------------+-------+
    | Number | Symbol | Name     | Discoverer             | Year  |
    | (INT)  | (STR)  | (STR)    | (STR)                  | (INT) |
    +--------+--------+----------+------------------------+-------+
    | 1      | H      | Hydrogen | Henry Cavendish        | 1766  |
    | 2      | He     | Helium   | Pierre Janssen         | 1895  |
    | 3      | Li     | Lithium  | Johan August Arfwedson | 1817  |
    +--------+--------+----------+------------------------+-------+
    Чтобы не вводить другие элементы вручную, добавьте в эту таблицу файл с их описанием. Он лежит в локальной файловой системе в каталоге /home/trainer/elements (подсказка - здесь поможет LOAD DATA INPATH)
    На основании DDL созданной таблицы создайте две другие таблицы, но в формате PARQUET, назовите их user50.elements (без сжатия) и user50.elements_old (со сжатием snappy).
    Переложите в них данные из исходной таблицы, причем в user50.elements положите все элементы, открытые после 1900 года, а в user50.elements_old - остальные.
    Вам предоставили файловую выгрузку в каталог /user/trainer/top100books. Создайте над ней внешнюю таблицу user50.external_top100books. Имена полей: book, author, year.